// Code generated by protoc-gen-bic. DO NOT EDIT.
// versions:1.1.0

package api

// This is a compile-time assertion to ensure that this generated file
// is compatible with the kratos package it is being compiled against.
import (
	"net/http"
	"protoc-gen-bic/example/gen"
	"strconv"

	"github.com/gin-gonic/gin"
)

func RegisterUserServiceHttpHandler(g *gin.RouterGroup, srvs UserService) {
	tmp := &x_UserService{xx: srvs}
	g.GET("/v1/users/", tmp.GetUsers)
	g.POST("/v1/users/", tmp.PostUsers)
	g.GET("/v1/users/:id/", tmp.GetUserInfo)
}

type UserService interface {
	GetUsers(ctx *gin.Context, in *RequestUsers) (out *ResponseUsers, code ErrCode)
	PostUsers(ctx *gin.Context, in *User) (out *ResponseNil, code ErrCode)
	GetUserInfo(ctx *gin.Context, in *RequestNil, id uint) (out *User, code ErrCode)
}

// generated http handle
type UserServiceHttpHandler interface {
	GetUsers(ctx *gin.Context)
	PostUsers(ctx *gin.Context)
	GetUserInfo(ctx *gin.Context)
}

type x_UserService struct {
	xx UserService
}

// @Summary 获取用户列表
// @Tags User-Service
// @Produce json
// @Param page query uint32 false "页码"
// @Param page_size query uint32 false "每页数量"
// @Success 200 {object} ResponseUsers
// @Failure 401 {string} string "header need Authorization data"
// @Failure 403 {string} string "no api permission or no obj permission"
// @Router /v1/users/ [GET]
func (x *x_UserService) GetUsers(ctx *gin.Context) {
	req := &RequestUsers{}
	if err := ctx.ShouldBindQuery(req); err != nil {
		ctx.JSON(http.StatusOK, gen.Response{400, " request error", nil})
		return
	}
	rsp, code := x.xx.GetUsers(ctx, req)

	ctx.JSON(http.StatusOK, gen.Response{
		Code:   int(code),
		Detail: code.String(),
		Data:   rsp,
	})
}

// @Summary 添加用户
// @Tags User-Service
// @Produce json
// @Param id body uint32 false "主键ID"
// @Param username body string false "用户名"
// @Param email body string false "邮箱"
// @Success 200 {object} ResponseNil
// @Failure 401 {string} string "header need Authorization data"
// @Failure 403 {string} string "no api permission or no obj permission"
// @Router /v1/users/ [POST]
func (x *x_UserService) PostUsers(ctx *gin.Context) {
	req := &User{}
	if err := ctx.Bind(req); err != nil {
		ctx.JSON(http.StatusOK, gen.Response{400, " request error", nil})
		return
	}
	rsp, code := x.xx.PostUsers(ctx, req)

	ctx.JSON(http.StatusOK, gen.Response{
		Code:   int(code),
		Detail: code.String(),
		Data:   rsp,
	})
}

// @Summary 获取用户详情
// @Tags User-Service
// @Produce json
// @Param id path uint true "some id"
// @Success 200 {object} User
// @Failure 401 {string} string "header need Authorization data"
// @Failure 403 {string} string "no api permission or no obj permission"
// @Router /v1/users/:id/ [GET]
func (x *x_UserService) GetUserInfo(ctx *gin.Context) {
	req := &RequestNil{}
	if err := ctx.ShouldBindQuery(req); err != nil {
		ctx.JSON(http.StatusOK, gen.Response{400, " request error", nil})
		return
	}
	id, err := strconv.Atoi(ctx.Param("id"))
	if err != nil || id < 0 {
		ctx.JSON(http.StatusBadRequest, gen.Response{
			Code:   int(ErrCode_param_error),
			Detail: "param id should be int",
		})
	}
	rsp, code := x.xx.GetUserInfo(ctx, req, uint(id))

	ctx.JSON(http.StatusOK, gen.Response{
		Code:   int(code),
		Detail: code.String(),
		Data:   rsp,
	})
}
